<%= turbo_frame_tag dom_id(listing, :hide_toggle) do %>
  <% hidden = current_user&.hiding?(listing) %>

  <% if hidden %>
    <div class="inline-flex items-center gap-2 rounded-md bg-gray-100 px-3 py-2 text-sm font-semibold text-gray-700 ring-1 ring-gray-200">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4 text-gray-500">
        <path fill-rule="evenodd" d="M3.707 2.293a1 1 0 010 1.414l1.35 1.35C3.049 6.3 1.63 7.874.967 9.102a1.314 1.314 0 000 1.184C2.23 12.734 5.614 16 10 16c1.586 0 3.07-.394 4.388-1.08l1.905 1.905a1 1 0 001.414-1.414l-14-14a1 1 0 00-1.414 0zm3.536 4.95l1.414 1.414A2 2 0 0110 10c.147 0 .29-.016.428-.046l1.603 1.603a3.5 3.5 0 01-4.788-4.314zM12.258 9.83l4.118 4.118a8.322 8.322 0 002.657-3.662.314.314 0 000-.272C17.77 8.266 14.386 5 10 5c-.999 0-1.95.16-2.84.45l1.625 1.625A3.5 3.5 0 0112.258 9.83z" clip-rule="evenodd" />
      </svg>
      <span>Hidden</span>
      <%= link_to "Undo",
                  hidden_listing_path(listing),
                  data: { turbo_method: :delete, turbo_stream: true },
                  class: "text-blue-700 hover:text-blue-800 underline decoration-blue-300 underline-offset-4" %>
    </div>
  <% else %>
    <%= link_to hidden_listings_path(listing_id: listing.id),
                data: { turbo_method: :post, turbo_stream: true },
                aria: { label: "Hide #{listing.title}" },
                class: "inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-700 shadow-sm transition hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1" do %>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="none" stroke="currentColor" class="h-5 w-5 text-gray-500">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.172 5.172C4.942 3.402 7.35 2.5 10 2.5c2.65 0 5.057.902 6.828 2.672.642.642.642 1.684 0 2.326C15.058 9.27 12.65 10.171 10 10.171c-2.65 0-5.058-.9-6.828-2.67a1.645 1.645 0 010-2.329z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.5 15.5l11-11" />
      </svg>
      <span>Hide</span>
    <% end %>
  <% end %>
<% end %>
