<div class="mt-6 rounded-xl border border-gray-200 bg-white/80 p-5 shadow-sm">
  <div class="flex items-center justify-between">
    <div>
      <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Seller tools</p>
      <h2 class="text-lg font-semibold text-gray-900">Offers on this listing</h2>
    </div>
    <span class="text-sm text-gray-400"><%= pluralize(bids.size, "offer") %></span>
  </div>

  <% if bids.any? %>
    <div class="mt-4 divide-y divide-gray-100">
      <% bids.each do |bid| %>
        <div class="py-4">
          <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
              <p class="text-base font-semibold text-gray-900"><%= bid.buyer.full_name %></p>
              <p class="text-sm text-gray-500">
                Offered <%= number_to_currency(bid.amount) %> â€¢ <%= time_ago_in_words(bid.created_at) %> ago
              </p>
              <% if bid.message.present? %>
                <p class="mt-1 text-sm italic text-gray-600">&ldquo;<%= bid.message %>&rdquo;</p>
              <% end %>
            </div>
            <span class="inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold <%= bid.pending? ? 'bg-yellow-50 text-yellow-700 ring-1 ring-yellow-100' : bid.accepted? ? 'bg-green-50 text-green-700 ring-1 ring-green-100' : bid.rejected? ? 'bg-red-50 text-red-700 ring-1 ring-red-100' : 'bg-blue-50 text-blue-700 ring-1 ring-blue-100' %>">
              <%= bid.status.humanize %>
            </span>
          </div>

          <% if bid.pending? %>
            <div class="mt-3 flex flex-wrap gap-3 text-sm">
              <%= form_with url: accept_bid_path(bid), method: :patch, local: true, class: "flex-1 min-w-[160px]" do |form| %>
                <div class="flex items-center gap-2">
                  <%= form.text_field :response_message,
                                      placeholder: "Optional note",
                                      class: "w-full rounded-lg border border-gray-200 px-2 py-1 text-sm" %>
                  <%= form.submit "Accept",
                                  class: "rounded-lg bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700" %>
                </div>
              <% end %>

              <%= form_with url: reject_bid_path(bid), method: :patch, local: true, class: "flex-1 min-w-[160px]" do |form| %>
                <div class="flex items-center gap-2">
                  <%= form.text_field :response_message,
                                      placeholder: "Optional note",
                                      class: "w-full rounded-lg border border-gray-200 px-2 py-1 text-sm" %>
                  <%= form.submit "Reject",
                                  class: "rounded-lg bg-red-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-red-700" %>
                </div>
              <% end %>

              <%= form_with url: counter_bid_path(bid), method: :patch, local: true, class: "flex-1 min-w-[220px]" do |form| %>
                <div class="grid grid-cols-[auto,1fr,auto] items-center gap-2">
                  <%= form.number_field :response_amount,
                                        step: 0.01,
                                        min: 0,
                                        required: true,
                                        placeholder: number_to_currency(bid.amount),
                                        class: "rounded-lg border border-gray-200 px-2 py-1 text-sm" %>
                  <%= form.text_field :response_message,
                                      placeholder: "Note",
                                      class: "rounded-lg border border-gray-200 px-2 py-1 text-sm" %>
                  <%= form.submit "Counter",
                                  class: "rounded-lg bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-blue-700" %>
                </div>
              <% end %>
            </div>
          <% else %>
            <div class="mt-3 rounded-lg bg-gray-50 p-3 text-sm text-gray-600">
              <% if bid.accepted? %>
                <p>You accepted this offer <%= time_ago_in_words(bid.responded_at) %> ago.</p>
              <% elsif bid.rejected? %>
                <p>You rejected this offer <%= time_ago_in_words(bid.responded_at) %> ago.</p>
              <% elsif bid.countered? %>
                <p>You countered with <%= number_to_currency(bid.response_amount) %> <%= time_ago_in_words(bid.responded_at) %> ago.</p>
              <% end %>
              <% if bid.response_message.present? %>
                <p class="mt-1 italic text-gray-500">&ldquo;<%= bid.response_message %>&rdquo;</p>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="mt-4 text-sm text-gray-500">No offers yet. Encourage buyers to make an offer by sharing your listing.</p>
  <% end %>
</div>
